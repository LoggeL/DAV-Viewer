(()=>{var e={};e.id=772,e.ids=[772],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{"use strict";e.exports=require("http")},8791:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},4026:e=>{"use strict";e.exports=require("string_decoder")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},8150:()=>{},4417:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p});var n={};r.r(n),r.d(n,{POST:()=>l});var a=r(9303),s=r(8716),o=r(3131),i=r(7070),u=r(8097);async function l(e){try{let t=await e.json();if((0,u.xf)(t)){(0,u.LO)();let{calendarUrl:e,event:r}=t;if(!e||!r)return i.NextResponse.json({error:"calendarUrl und event sind erforderlich"},{status:400});let n=u.Ig.events.get(e)||[],a=r.uid||(0,u.vk)(10),s=`${e}/evt-${a}.ics`,o=`"${(0,u.vk)(6)}"`,l={href:s,etag:o,uid:a,summary:r.summary||"",description:r.description||"",location:r.location||"",start:r.start,end:r.end,allDay:!!r.allDay};return n.push(l),u.Ig.events.set(e,n),i.NextResponse.json({href:s,etag:o})}(0,u.R4)(t);let{serverUrl:r,username:n,password:a,calendarUrl:s,event:o}=t;if(!s||!o)return i.NextResponse.json({error:"calendarUrl und event sind erforderlich"},{status:400});let l=await (0,u.kH)({serverUrl:r,username:n,password:a}),c=(await l.fetchCalendars()).find(e=>e.url===s);if(!c)return i.NextResponse.json({error:"Kalender nicht gefunden"},{status:404});let d=(0,u.Jp)(o),p=`${o.uid||(0,u.vk)()}.ics`,m=await l.createCalendarObject({calendar:c,iCalString:d,filename:p});return i.NextResponse.json({href:m?.href,etag:m?.etag})}catch(e){return i.NextResponse.json({error:e.message||"Fehler"},{status:e.status||500})}}let c=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/create-event/route",pathname:"/api/create-event",filename:"route",bundlePath:"app/api/create-event/route"},resolvedPagePath:"/workspace/app/api/create-event/route.js",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:m}=c,f="/api/create-event/route";function v(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:p})}},8097:(e,t,r)=>{"use strict";r.d(t,{Ig:()=>i,Jp:()=>p,LO:()=>u,R4:()=>l,kH:()=>c,ke:()=>d,vk:()=>m,xf:()=>o});var n=r(9394),a=r(1625);let s="1"===process.env.DEMO||"1"===process.env.DEMO_MODE;function o(e){return!!s||!!e&&(!0===e.demo||"string"==typeof e.serverUrl&&"demo"===e.serverUrl.trim().toLowerCase())}let i={calendars:[{url:"demo://work",displayName:"Work",ctag:"1",color:"#3b82f6"},{url:"demo://personal",displayName:"Personal",ctag:"1",color:"#22c55e"}],events:new Map};function u(){if(i.events.size>0)return;let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),9,0,0,0),r=(e,r,n=1,a="Meeting",s=!1)=>{let o=new Date(t.getTime()+864e5*r),i=new Date(o.getTime()+36e5*n),u=m(10);return{href:`${e}/evt-${u}.ics`,etag:`"${m(6)}"`,uid:u,summary:a,description:"",location:"",start:o.toISOString(),end:i.toISOString(),allDay:s}};i.events.set("demo://work",[r("demo://work",-2,1,"Sync mit Team"),r("demo://work",-1,2,"Projekt Kickoff"),r("demo://work",0,1,"1:1 Check-in"),r("demo://work",1,1,"Architektur-Review"),r("demo://work",3,2,"Sprint Planung")]),i.events.set("demo://personal",[r("demo://personal",0,0,"Geburtstag",!0),r("demo://personal",2,1,"Arzttermin"),r("demo://personal",4,1,"Laufen im Park"),r("demo://personal",6,2,"Familienessen"),r("demo://personal",-3,1,"Einkaufen")])}function l(e){if(o(e))return;let{serverUrl:t,username:r,password:n}=e||{};if(!t||!r||!n){let e=Error("serverUrl, username und password sind erforderlich");throw e.status=400,e}}async function c({serverUrl:e,username:t,password:r}){let n=await (0,a.G6)({serverUrl:e,credentials:{username:t,password:r},authMethod:"Basic",defaultAccountType:"caldav"});return await n.login(),n}function d(e){try{let t=n.Z.parse(e),r=new n.Z.Component(t).getFirstSubcomponent("vevent");if(!r)return null;let a=new n.Z.Event(r);return{uid:a.uid,summary:a.summary||"",description:a.description||"",location:a.location||"",start:a.startDate?a.startDate.toJSDate():null,end:a.endDate?a.endDate.toJSDate():null,allDay:!!a.startDate&&a.startDate.isDate}}catch(e){return null}}function p({uid:e,summary:t,description:r,location:a,start:s,end:o,allDay:i}){let u=new n.Z.Component(["vcalendar",[],[]]);u.updatePropertyWithValue("prodid","-//CalDAV Webapp//EN"),u.updatePropertyWithValue("version","2.0");let l=new n.Z.Component("vevent"),c=new n.Z.Event(l);e&&(c.uid=e);let d=new Date(s),p=new Date(o);if(i){let e=n.Z.Time.fromJSDate(d,!1);e.isDate=!0;let t=n.Z.Time.fromJSDate(p,!1);t.isDate=!0,c.startDate=e,c.endDate=t}else{let e=n.Z.Time.fromJSDate(d,!0),t=n.Z.Time.fromJSDate(p,!0);c.startDate=e,c.endDate=t}return c.summary=t||"",c.description=r||"",c.location=a||"",u.addSubcomponent(l),u.toString()}function m(e=16){let t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",r="";for(let n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,801],()=>r(4417));module.exports=n})();