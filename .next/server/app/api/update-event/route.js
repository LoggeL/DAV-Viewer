(()=>{var e={};e.id=539,e.ids=[539],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{"use strict";e.exports=require("http")},8791:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},4026:e=>{"use strict";e.exports=require("string_decoder")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},8150:()=>{},7877:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>v,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>c});var n={};r.r(n),r.d(n,{POST:()=>l});var a=r(9303),o=r(8716),s=r(3131),i=r(7070),u=r(8097);async function l(e){try{let t=await e.json();if((0,u.xf)(t)){(0,u.LO)();let{calendarObjectUrl:e,event:r}=t;if(!e||!r)return i.NextResponse.json({error:"calendarObjectUrl und event sind erforderlich"},{status:400});let n=e.split("/").slice(0,3).join("/"),a=u.Ig.events.get(n)||[],o=a.findIndex(t=>t.href===e);if(-1===o)return i.NextResponse.json({error:"Demo-Termin nicht gefunden"},{status:404});let s=a[o],l=`"${(0,u.vk)(6)}"`;return a[o]={...s,summary:r.summary||"",description:r.description||"",location:r.location||"",start:r.start,end:r.end,allDay:!!r.allDay,etag:l},u.Ig.events.set(n,a),i.NextResponse.json({ok:!0,etag:l})}(0,u.R4)(t);let{serverUrl:r,username:n,password:a,calendarObjectUrl:o,etag:s,event:l}=t;if(!o||!l)return i.NextResponse.json({error:"calendarObjectUrl und event sind erforderlich"},{status:400});let d=await (0,u.kH)({serverUrl:r,username:n,password:a}),p=(0,u.Jp)(l),c=await d.updateCalendarObject({calendarObject:{url:o,etag:s},iCalString:p});return i.NextResponse.json({ok:!0,etag:c?.etag})}catch(e){return i.NextResponse.json({error:e.message||"Fehler"},{status:e.status||500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/update-event/route",pathname:"/api/update-event",filename:"route",bundlePath:"app/api/update-event/route"},resolvedPagePath:"/workspace/app/api/update-event/route.js",nextConfigOutput:"",userland:n}),{requestAsyncStorage:p,staticGenerationAsyncStorage:c,serverHooks:m}=d,f="/api/update-event/route";function v(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:c})}},8097:(e,t,r)=>{"use strict";r.d(t,{Ig:()=>i,Jp:()=>c,LO:()=>u,R4:()=>l,kH:()=>d,ke:()=>p,vk:()=>m,xf:()=>s});var n=r(9394),a=r(1625);let o="1"===process.env.DEMO||"1"===process.env.DEMO_MODE;function s(e){return!!o||!!e&&(!0===e.demo||"string"==typeof e.serverUrl&&"demo"===e.serverUrl.trim().toLowerCase())}let i={calendars:[{url:"demo://work",displayName:"Work",ctag:"1",color:"#3b82f6"},{url:"demo://personal",displayName:"Personal",ctag:"1",color:"#22c55e"}],events:new Map};function u(){if(i.events.size>0)return;let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),9,0,0,0),r=(e,r,n=1,a="Meeting",o=!1)=>{let s=new Date(t.getTime()+864e5*r),i=new Date(s.getTime()+36e5*n),u=m(10);return{href:`${e}/evt-${u}.ics`,etag:`"${m(6)}"`,uid:u,summary:a,description:"",location:"",start:s.toISOString(),end:i.toISOString(),allDay:o}};i.events.set("demo://work",[r("demo://work",-2,1,"Sync mit Team"),r("demo://work",-1,2,"Projekt Kickoff"),r("demo://work",0,1,"1:1 Check-in"),r("demo://work",1,1,"Architektur-Review"),r("demo://work",3,2,"Sprint Planung")]),i.events.set("demo://personal",[r("demo://personal",0,0,"Geburtstag",!0),r("demo://personal",2,1,"Arzttermin"),r("demo://personal",4,1,"Laufen im Park"),r("demo://personal",6,2,"Familienessen"),r("demo://personal",-3,1,"Einkaufen")])}function l(e){if(s(e))return;let{serverUrl:t,username:r,password:n}=e||{};if(!t||!r||!n){let e=Error("serverUrl, username und password sind erforderlich");throw e.status=400,e}}async function d({serverUrl:e,username:t,password:r}){let n=await (0,a.G6)({serverUrl:e,credentials:{username:t,password:r},authMethod:"Basic",defaultAccountType:"caldav"});return await n.login(),n}function p(e){try{let t=n.Z.parse(e),r=new n.Z.Component(t).getFirstSubcomponent("vevent");if(!r)return null;let a=new n.Z.Event(r);return{uid:a.uid,summary:a.summary||"",description:a.description||"",location:a.location||"",start:a.startDate?a.startDate.toJSDate():null,end:a.endDate?a.endDate.toJSDate():null,allDay:!!a.startDate&&a.startDate.isDate}}catch(e){return null}}function c({uid:e,summary:t,description:r,location:a,start:o,end:s,allDay:i}){let u=new n.Z.Component(["vcalendar",[],[]]);u.updatePropertyWithValue("prodid","-//CalDAV Webapp//EN"),u.updatePropertyWithValue("version","2.0");let l=new n.Z.Component("vevent"),d=new n.Z.Event(l);e&&(d.uid=e);let p=new Date(o),c=new Date(s);if(i){let e=n.Z.Time.fromJSDate(p,!1);e.isDate=!0;let t=n.Z.Time.fromJSDate(c,!1);t.isDate=!0,d.startDate=e,d.endDate=t}else{let e=n.Z.Time.fromJSDate(p,!0),t=n.Z.Time.fromJSDate(c,!0);d.startDate=e,d.endDate=t}return d.summary=t||"",d.description=r||"",d.location=a||"",u.addSubcomponent(l),u.toString()}function m(e=16){let t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",r="";for(let n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,801],()=>r(7877));module.exports=n})();