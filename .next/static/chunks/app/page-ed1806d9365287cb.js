(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4761:function(e,r,a){Promise.resolve().then(a.bind(a,434))},434:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return o}});var t=a(7437),n=a(2265),s=a(9376);function l(){let e=(0,s.useRouter)(),r=(0,s.useSearchParams)(),[a,l]=(0,n.useState)(""),[o,i]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),[c,m]=(0,n.useState)(""),[h,p]=(0,n.useState)("");async function f(r){var t,n;null==r||null===(t=r.preventDefault)||void 0===t||t.call(r),m("Verbinde...");try{let r=await fetch("/api/list-calendars",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({serverUrl:a.trim(),username:o.trim(),password:d})}),t=await r.json();if(!r.ok)throw Error((null==t?void 0:t.error)||"Fehler");let s={serverUrl:a.trim(),username:o.trim(),password:d,calendars:t.calendars||[],selectedCalendarUrls:(t.calendars||[]).map(e=>e.url)};localStorage.setItem("caldavWebappCredsV2",JSON.stringify(s)),m("".concat((null===(n=t.calendars)||void 0===n?void 0:n.length)||0," Kalender geladen.")),e.push("/calendar")}catch(e){m(e.message||"Fehler bei der Verbindung")}}async function v(){p("Demo wird geladen...");try{let r=await fetch("/api/list-calendars",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({demo:!0})}),a=await r.json();if(!r.ok)throw Error((null==a?void 0:a.error)||"Fehler");let t={serverUrl:"demo",username:"demo",password:"demo",calendars:a.calendars||[],selectedCalendarUrls:(a.calendars||[]).map(e=>e.url)};localStorage.setItem("caldavWebappCredsV2",JSON.stringify(t)),p(""),e.push("/calendar?demo=1")}catch(e){p(e.message||"Demo konnte nicht geladen werden")}}return(0,n.useEffect)(()=>{if("1"===(null==r?void 0:r.get("demo")))v();else try{let e=localStorage.getItem("caldavWebappCredsV2");if(e){let r=JSON.parse(e);l(r.serverUrl||""),i(r.username||""),u(r.password||"")}}catch(e){}},[]),(0,t.jsxs)("section",{className:"card",children:[(0,t.jsx)("h2",{children:"Verbindung"}),(0,t.jsxs)("form",{onSubmit:f,children:[(0,t.jsxs)("div",{className:"row",children:[(0,t.jsx)("button",{type:"button",onClick:v,title:"Frontend im Demo-Modus testen",children:"Demo starten"}),(0,t.jsx)("span",{className:"msg",children:h})]}),(0,t.jsxs)("label",{children:["Server URL",(0,t.jsx)("input",{type:"url",placeholder:"https://example.com/caldav/",required:!0,value:a,onChange:e=>l(e.target.value)})]}),(0,t.jsxs)("label",{children:["Benutzername",(0,t.jsx)("input",{type:"text",required:!0,value:o,onChange:e=>i(e.target.value)})]}),(0,t.jsxs)("label",{children:["Kennwort",(0,t.jsx)("input",{type:"password",required:!0,value:d,onChange:e=>u(e.target.value)})]}),(0,t.jsx)("button",{type:"submit",children:"Kalender laden"})]}),(0,t.jsx)("div",{className:"msg",children:c})]})}function o(){return(0,t.jsx)(n.Suspense,{fallback:null,children:(0,t.jsx)(l,{})})}},9376:function(e,r,a){"use strict";var t=a(5475);a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(r,{useSearchParams:function(){return t.useSearchParams}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=4761)}),_N_E=e.O()}]);